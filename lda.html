<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Legal Document Analyzer - Professional Law Firm Solution</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="api-integrations.js"></script>
    <script src="setup-api-keys.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: linear-gradient(90deg, #1a1a2e 0%, #16213e 100%);
            border-bottom: 3px solid #d4af37;
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.5em;
            color: #d4af37;
        }

        .logo h1 {
            font-size: 1.8em;
            font-weight: 700;
            color: #ffffff;
        }

        .logo span {
            color: #d4af37;
            font-size: 0.9em;
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #d4af37, #f4d03f);
            color: #1a1a2e;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: #d4af37;
            border: 2px solid #d4af37;
        }

        .btn-secondary:hover {
            background: #d4af37;
            color: #1a1a2e;
        }

        /* Navigation */
        nav {
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(10px);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-tabs {
            display: flex;
            list-style: none;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
        }

        .nav-tab button {
            width: 100%;
            padding: 18px 20px;
            background: transparent;
            border: none;
            color: #ffffff;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-tab button:hover {
            background: rgba(212, 175, 55, 0.1);
            color: #d4af37;
        }

        .nav-tab button.active {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            border-bottom-color: #d4af37;
        }

        /* Main Content */
        main {
            padding: 40px 0;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(212, 175, 55, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #d4af37;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed #d4af37;
            border-radius: 12px;
            padding: 60px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(212, 175, 55, 0.05);
        }

        .upload-area:hover {
            background: rgba(212, 175, 55, 0.1);
            border-color: #f4d03f;
        }

        .upload-area.dragover {
            background: rgba(212, 175, 55, 0.15);
            border-color: #f4d03f;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4em;
            color: #d4af37;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #cccccc;
            font-size: 0.9em;
        }

        /* File List */
        .file-list {
            margin-top: 20px;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .file-icon {
            font-size: 1.5em;
            color: #d4af37;
        }

        .file-details h4 {
            margin-bottom: 5px;
        }

        .file-details span {
            color: #cccccc;
            font-size: 0.9em;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.8em;
        }

        /* Chat Interface */
        .chat-container {
            height: 500px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            background: rgba(0, 0, 0, 0.3);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            scroll-behavior: smooth;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #d4af37, #f4d03f);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a1a2e;
            font-weight: bold;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: linear-gradient(45deg, #4a90e2, #357abd);
        }

        .message-content {
            max-width: 70%;
            padding: 15px 20px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .message.user .message-content {
            background: rgba(74, 144, 226, 0.2);
            border-color: rgba(74, 144, 226, 0.3);
        }

        .chat-input {
            display: flex;
            padding: 20px;
            gap: 15px;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
        }

        .chat-input input {
            flex: 1;
            padding: 15px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-size: 16px;
        }

        .chat-input input::placeholder {
            color: #cccccc;
        }

        .chat-input button {
            padding: 15px 25px;
            border-radius: 25px;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #d4af37;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Search Results */
        .search-results {
            margin-top: 30px;
        }

        .search-result {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .search-result:hover {
            border-color: rgba(212, 175, 55, 0.4);
            transform: translateX(5px);
        }

        .search-result h3 {
            color: #d4af37;
            margin-bottom: 10px;
        }

        .search-result .case-info {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .case-info span {
            background: rgba(212, 175, 55, 0.1);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            color: #d4af37;
        }

        /* Progress Bar */
        .progress-container {
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #d4af37, #f4d03f);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            color: #d4af37;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-top: 2px solid #d4af37;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 10px 0;
        }

        .typing-indicator .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #d4af37;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-indicator .dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-indicator .dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }

        /* API Integration Styles */
        .api-fallback-notice {
            background: linear-gradient(90deg, #ffa500, #ff6b35);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #ff4500;
        }

        .api-fallback-notice i {
            margin-right: 8px;
        }

        .translation-pair {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .source-text, .target-text {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        .translation-actions, .search-actions {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        .search-metadata {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .search-content {
            background: rgba(255, 255, 255, 0.02);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.2);
            line-height: 1.6;
        }

        .summary-content {
            background: rgba(255, 255, 255, 0.02);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .summary-text {
            margin-top: 15px;
            line-height: 1.8;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .logo h1 {
                font-size: 1.5em;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .nav-tab {
                min-width: auto;
            }

            .card {
                padding: 20px;
            }

            .message-content {
                max-width: 85%;
            }

            .case-info {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        .slide-up {
            animation: slideUp 0.5s ease-in-out;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        .flex { display: flex; }
        .flex-column { flex-direction: column; }
        .gap-10 { gap: 10px; }
        .gap-20 { gap: 20px; }
        .justify-between { justify-content: space-between; }
        .align-center { align-items: center; }

        /* Document Viewer */
        .document-viewer {
            height: 600px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            overflow-y: auto;
        }

        .document-content {
            line-height: 1.8;
            font-size: 16px;
        }

        .highlight {
            background: rgba(212, 175, 55, 0.3);
            padding: 2px 4px;
            border-radius: 3px;
        }

        /* Export Options */
        .export-options {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: #d4af37;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: rgba(212, 175, 55, 0.2);
            border-color: #d4af37;
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .status-success {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .status-processing {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            border: 1px solid rgba(241, 196, 15, 0.3);
        }

        .status-error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        /* Enhanced AI Services Dashboard */
        .ai-services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .service-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.2);
        }

        .service-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .service-header i {
            font-size: 1.5em;
            color: #d4af37;
        }

        .service-header .status-indicator {
            margin-left: auto;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .status-online {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 1px solid #4CAF50;
        }

        .status-offline {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }

        .status-checking {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
            border: 1px solid #FFC107;
        }

        .service-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .feature-tag {
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.8em;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        /* Risk Assessment Components */
        .risk-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            flex: 1;
        }

        .risk-indicator {
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 10px;
        }

        .risk-low { color: #4CAF50; }
        .risk-medium { color: #FFC107; }
        .risk-high { color: #f44336; }

        /* Performance Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #d4af37;
            margin-top: 8px;
        }

        /* Analysis Content */
        .analysis-content {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            line-height: 1.6;
        }

        .api-fallback-notice {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid #FFC107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            color: #FFC107;
        }

        /* Responsive Design for Enhanced Features */
        @media (max-width: 768px) {
            .ai-services-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .risk-card {
                margin-bottom: 10px;
            }

            .service-features {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-balance-scale"></i>
                    <div>
                        <h1>Indian Legal Document Analyzer</h1>
                        <span>Professional Law Firm Solution</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary">
                        <i class="fas fa-download"></i>
                        Export Report
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-user-circle"></i>
                        Sign In
                    </button>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul class="nav-tabs">
                <li class="nav-tab">
                    <button class="tab-btn active" data-tab="upload">
                        <i class="fas fa-upload"></i>
                        Document Upload
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="summarize">
                        <i class="fas fa-file-alt"></i>
                        Summarization
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="qa">
                        <i class="fas fa-question-circle"></i>
                        Legal Q&A
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="translate">
                        <i class="fas fa-language"></i>
                        Translation
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="search">
                        <i class="fas fa-search"></i>
                        Search & Analysis
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="viewer">
                        <i class="fas fa-eye"></i>
                        Document Viewer
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="comparison">
                        <i class="fas fa-balance-scale"></i>
                        Document Compare
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="risk">
                        <i class="fas fa-shield-alt"></i>
                        Risk Assessment
                    </button>
                </li>
                <li class="nav-tab">
                    <button class="tab-btn" data-tab="ai-status">
                        <i class="fas fa-robot"></i>
                        AI Services
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="container">
            <!-- Document Upload Tab -->
            <div id="upload" class="tab-content active">
                <div class="card">
                    <h2><i class="fas fa-cloud-upload-alt"></i> Document Upload & Processing</h2>
                    
                    <div class="upload-area" onclick="document.getElementById('file-input').click()">
                        <div class="upload-icon">
                            <i class="fas fa-file-upload"></i>
                        </div>
                        <div class="upload-text">Click to upload or drag and drop your legal documents</div>
                        <div class="upload-subtext">Supports PDF, DOC, DOCX, TXT files up to 50MB</div>
                    </div>
                    
                    <input type="file" id="file-input" multiple accept=".pdf,.doc,.docx,.txt" style="display: none;">
                    
                    <div class="file-list" id="file-list"></div>
                    
                    <div class="progress-container" id="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <p id="progress-text">Processing documents...</p>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-chart-bar"></i> Document Analysis Overview</h2>
                    <div id="analysis-overview">
                        <p>Upload documents to view comprehensive analysis including:</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Legal entity extraction (parties, judges, lawyers)</li>
                            <li>Key date and timeline identification</li>
                            <li>Case number and citation references</li>
                            <li>Legal section and act references</li>
                            <li>Document classification and type</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Summarization Tab -->
            <div id="summarize" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-compress-alt"></i> AI-Powered Legal Document Summarization</h2>
                    
                    <div class="form-group">
                        <label for="summary-type">Summary Type</label>
                        <select id="summary-type">
                            <option value="comprehensive">Comprehensive Summary</option>
                            <option value="executive">Executive Summary</option>
                            <option value="key-points">Key Points Only</option>
                            <option value="timeline">Timeline Summary</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="summary-length">Summary Length</label>
                        <select id="summary-length">
                            <option value="short">Short (1-2 paragraphs)</option>
                            <option value="medium">Medium (3-5 paragraphs)</option>
                            <option value="long">Long (Detailed analysis)</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="generateSummary()">
                        <i class="fas fa-magic"></i>
                        Generate Summary
                    </button>
                    
                    <div id="summary-result" style="display: none; margin-top: 30px;">
                        <h3 style="color: #d4af37; margin-bottom: 20px;">Document Summary</h3>
                        <div id="summary-content" class="document-content"></div>
                        
                        <div class="export-options">
                            <button class="export-btn" onclick="exportSummary('pdf')">
                                <i class="fas fa-file-pdf"></i> Export as PDF
                            </button>
                            <button class="export-btn" onclick="exportSummary('word')">
                                <i class="fas fa-file-word"></i> Export as Word
                            </button>
                            <button class="export-btn" onclick="exportSummary('text')">
                                <i class="fas fa-file-alt"></i> Export as Text
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Legal Q&A Tab -->
            <div id="qa" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-comments"></i> Legal Q&A Assistant</h2>
                    
                    <div class="chat-container">
                        <div class="chat-messages" id="chat-messages">
                            <div class="message">
                                <div class="message-avatar">AI</div>
                                <div class="message-content">
                                    <p>Hello! I'm your AI legal assistant specialized in Indian law. I can help you with:</p>
                                    <ul style="margin-left: 20px; margin-top: 10px;">
                                        <li>Questions about Indian legal procedures</li>
                                        <li>Explanations of legal concepts and terms</li>
                                        <li>Analysis of your uploaded documents</li>
                                        <li>Guidance on case law and precedents</li>
                                        <li>Information about various Indian legal acts</li>
                                    </ul>
                                    <p style="margin-top: 10px;">What legal question can I help you with today?</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chat-input">
                            <input type="text" id="chat-input" placeholder="Ask any question about Indian law or your documents...">
                            <button class="btn btn-primary" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i>
                                Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Translation Tab -->
            <div id="translate" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-globe"></i> Multilingual Legal Document Translation</h2>
                    
                    <div class="flex gap-20" style="margin-bottom: 20px;">
                        <div class="form-group" style="flex: 1;">
                            <label for="source-lang">Source Language</label>
                            <select id="source-lang">
                                <option value="auto">Auto-detect</option>
                                <option value="en">English</option>
                                <option value="hi">Hindi (हिंदी)</option>
                                <option value="ta">Tamil (தமிழ்)</option>
                                <option value="bn">Bengali (বাংলা)</option>
                                <option value="te">Telugu (తెలుగు)</option>
                                <option value="mr">Marathi (मराठी)</option>
                                <option value="gu">Gujarati (ગુજરાતી)</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="flex: 1;">
                            <label for="target-lang">Target Language</label>
                            <select id="target-lang">
                                <option value="en">English</option>
                                <option value="hi">Hindi (हिंदी)</option>
                                <option value="ta">Tamil (தமிழ்)</option>
                                <option value="bn">Bengali (বাংলা)</option>
                                <option value="te">Telugu (తెలుగు)</option>
                                <option value="mr">Marathi (मराठी)</option>
                                <option value="gu">Gujarati (ગુજરાતી)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="translation-text">Text to Translate</label>
                        <textarea id="translation-text" placeholder="Enter legal text to translate or select from uploaded documents..."></textarea>
                    </div>
                    
                    <div class="flex gap-10 mb-20">
                        <button class="btn btn-primary" onclick="translateText()">
                            <i class="fas fa-exchange-alt"></i>
                            Translate
                        </button>
                        <button class="btn btn-secondary" onclick="swapLanguages()">
                            <i class="fas fa-retweet"></i>
                            Swap Languages
                        </button>
                    </div>
                    
                    <div id="translation-result" style="display: none;">
                        <h3 style="color: #d4af37; margin-bottom: 15px;">Translation Result</h3>
                        <div class="document-content" id="translation-output" style="background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.2);"></div>
                        
                        <div class="export-options">
                            <button class="export-btn" onclick="exportTranslation()">
                                <i class="fas fa-download"></i> Export Translation
                            </button>
                            <button class="export-btn" onclick="copyTranslation()">
                                <i class="fas fa-copy"></i> Copy to Clipboard
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search & Analysis Tab -->
            <div id="search" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-search-plus"></i> Semantic Search & Legal Analysis</h2>
                    
                    <div class="form-group">
                        <label for="search-query">Search Query</label>
                        <input type="text" id="search-query" placeholder="Enter legal terms, case names, or questions...">
                    </div>
                    
                    <div class="flex gap-20 mb-20">
                        <div class="form-group" style="flex: 1;">
                            <label for="search-type">Search Type</label>
                            <select id="search-type">
                                <option value="semantic">Semantic Search</option>
                                <option value="exact">Exact Match</option>
                                <option value="similar">Similar Cases</option>
                                <option value="precedent">Legal Precedents</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="flex: 1;">
                            <label for="search-jurisdiction">Jurisdiction</label>
                            <select id="search-jurisdiction">
                                <option value="all">All India</option>
                                <option value="supreme">Supreme Court</option>
                                <option value="high">High Courts</option>
                                <option value="district">District Courts</option>
                                <option value="tribunal">Tribunals</option>
                            </select>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="performSearch()">
                        <i class="fas fa-search"></i>
                        Search Legal Database
                    </button>
                    
                    <div id="search-results" class="search-results" style="display: none;"></div>
                </div>
            </div>

            <!-- Document Viewer Tab -->
            <div id="viewer" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-file-text"></i> Interactive Document Viewer</h2>
                    
                    <div class="flex gap-20 mb-20">
                        <div class="form-group" style="flex: 1;">
                            <label for="viewer-document">Select Document</label>
                            <select id="viewer-document">
                                <option value="">Select a document to view...</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="flex: 1;">
                            <label for="viewer-search">Search in Document</label>
                            <input type="text" id="viewer-search" placeholder="Search text in document...">
                        </div>
                    </div>
                    
                    <div class="flex gap-10 mb-20">
                        <button class="btn btn-secondary btn-small" onclick="highlightEntities()">
                            <i class="fas fa-highlighter"></i>
                            Highlight Entities
                        </button>
                        <button class="btn btn-secondary btn-small" onclick="highlightDates()">
                            <i class="fas fa-calendar"></i>
                            Highlight Dates
                        </button>
                        <button class="btn btn-secondary btn-small" onclick="highlightCitations()">
                            <i class="fas fa-quote-right"></i>
                            Highlight Citations
                        </button>
                    </div>
                    
                    <div class="document-viewer" id="document-viewer">
                        <div class="text-center" style="padding: 50px;">
                            <i class="fas fa-file-alt" style="font-size: 3em; color: #d4af37; margin-bottom: 20px;"></i>
                            <p>Select a document from the dropdown above to view its content</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Document Comparison Tab -->
            <div id="comparison" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-balance-scale"></i> AI-Powered Document Comparison</h2>
                    <p>Compare two legal documents using advanced AI analysis to identify differences, similarities, and legal implications.</p>
                    
                    <div class="flex gap-20 mb-20">
                        <div class="form-group" style="flex: 1;">
                            <label for="compare-doc1">Document 1</label>
                            <select id="compare-doc1">
                                <option value="">Select first document...</option>
                            </select>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <label for="compare-doc2">Document 2</label>
                            <select id="compare-doc2">
                                <option value="">Select second document...</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex gap-10 mb-20">
                        <button class="btn btn-primary" onclick="compareDocuments()">
                            <i class="fas fa-exchange-alt"></i>
                            Compare Documents
                        </button>
                        <button class="btn btn-secondary" onclick="exportComparison()">
                            <i class="fas fa-download"></i>
                            Export Analysis
                        </button>
                    </div>
                    
                    <div id="comparison-result" class="result-section" style="display: none;">
                        <h3>AI Comparison Analysis</h3>
                        <div id="comparison-content" class="analysis-content"></div>
                    </div>
                </div>
            </div>

            <!-- Risk Assessment Tab -->
            <div id="risk" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-shield-alt"></i> Legal Risk Assessment</h2>
                    <p>Advanced AI-powered risk analysis using multiple models for comprehensive legal document evaluation.</p>
                    
                    <div class="form-group mb-20">
                        <label for="risk-document">Select Document for Risk Assessment</label>
                        <select id="risk-document">
                            <option value="">Choose document to assess...</option>
                        </select>
                    </div>
                    
                    <div class="flex gap-10 mb-20">
                        <button class="btn btn-primary" onclick="assessRisk()">
                            <i class="fas fa-search"></i>
                            Analyze Risk
                        </button>
                        <button class="btn btn-secondary" onclick="generateRiskReport()">
                            <i class="fas fa-file-pdf"></i>
                            Generate Report
                        </button>
                    </div>
                    
                    <div id="risk-result" class="result-section" style="display: none;">
                        <h3>Multi-AI Risk Assessment</h3>
                        <div id="risk-content" class="analysis-content"></div>
                        
                        <div class="risk-metrics" style="margin-top: 20px;">
                            <div class="flex gap-20">
                                <div class="risk-card">
                                    <h4>Risk Level</h4>
                                    <div id="risk-level" class="risk-indicator">Analyzing...</div>
                                </div>
                                <div class="risk-card">
                                    <h4>Compliance Score</h4>
                                    <div id="compliance-score" class="risk-indicator">Calculating...</div>
                                </div>
                                <div class="risk-card">
                                    <h4>Entities Detected</h4>
                                    <div id="entities-count" class="risk-indicator">Processing...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Services Status Tab -->
            <div id="ai-status" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-robot"></i> AI Services Dashboard</h2>
                    <p>Monitor and configure your AI service integrations for optimal performance.</p>
                    
                    <div class="ai-services-grid">
                        <div class="service-card">
                            <div class="service-header">
                                <i class="fab fa-openai"></i>
                                <h3>OpenAI</h3>
                                <span id="openai-status" class="status-indicator">Checking...</span>
                            </div>
                            <p>Advanced GPT models for summarization and Q&A</p>
                            <div class="service-features">
                                <span class="feature-tag">Document Analysis</span>
                                <span class="feature-tag">Legal Q&A</span>
                                <span class="feature-tag">Summarization</span>
                            </div>
                        </div>

                        <div class="service-card">
                            <div class="service-header">
                                <i class="fas fa-google"></i>
                                <h3>Google Gemini</h3>
                                <span id="gemini-status" class="status-indicator">Checking...</span>
                            </div>
                            <p>Google's latest AI model for comprehensive analysis</p>
                            <div class="service-features">
                                <span class="feature-tag">Multi-modal AI</span>
                                <span class="feature-tag">Legal Research</span>
                                <span class="feature-tag">Risk Assessment</span>
                            </div>
                        </div>

                        <div class="service-card">
                            <div class="service-header">
                                <i class="fas fa-language"></i>
                                <h3>Google Translate</h3>
                                <span id="translate-status" class="status-indicator">Checking...</span>
                            </div>
                            <p>Professional legal document translation</p>
                            <div class="service-features">
                                <span class="feature-tag">6+ Languages</span>
                                <span class="feature-tag">Context-Aware</span>
                                <span class="feature-tag">Legal Terms</span>
                            </div>
                        </div>

                        <div class="service-card">
                            <div class="service-header">
                                <i class="fas fa-file-text"></i>
                                <h3>Document AI</h3>
                                <span id="docai-status" class="status-indicator">Checking...</span>
                            </div>
                            <p>Advanced OCR and document structure analysis</p>
                            <div class="service-features">
                                <span class="feature-tag">OCR</span>
                                <span class="feature-tag">Layout Analysis</span>
                                <span class="feature-tag">Form Processing</span>
                            </div>
                        </div>

                        <div class="service-card">
                            <div class="service-header">
                                <i class="fas fa-brain"></i>
                                <h3>Natural Language</h3>
                                <span id="nlp-status" class="status-indicator">Checking...</span>
                            </div>
                            <p>Entity extraction and sentiment analysis</p>
                            <div class="service-features">
                                <span class="feature-tag">Entity Recognition</span>
                                <span class="feature-tag">Sentiment Analysis</span>
                                <span class="feature-tag">Classification</span>
                            </div>
                        </div>

                        <div class="service-card">
                            <div class="service-header">
                                <i class="fas fa-code"></i>
                                <h3>Hugging Face</h3>
                                <span id="hf-status" class="status-indicator">Checking...</span>
                            </div>
                            <p>Specialized legal AI models and NER</p>
                            <div class="service-features">
                                <span class="feature-tag">Legal BERT</span>
                                <span class="feature-tag">Specialized Models</span>
                                <span class="feature-tag">Open Source</span>
                            </div>
                        </div>
                    </div>

                    <div class="ai-performance-metrics" style="margin-top: 30px;">
                        <h3>Performance Metrics</h3>
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <h4>Total Documents Processed</h4>
                                <div id="docs-processed" class="metric-value">0</div>
                            </div>
                            <div class="metric-card">
                                <h4>AI Queries Today</h4>
                                <div id="queries-today" class="metric-value">0</div>
                            </div>
                            <div class="metric-card">
                                <h4>Average Response Time</h4>
                                <div id="avg-response-time" class="metric-value">--ms</div>
                            </div>
                            <div class="metric-card">
                                <h4>Success Rate</h4>
                                <div id="success-rate" class="metric-value">--%</div>
                            </div>
                        </div>
                    </div>

                    <div class="configuration-section" style="margin-top: 30px;">
                        <h3>Quick Configuration</h3>
                        <p>Configure your API keys for enhanced functionality:</p>
                        <div class="flex gap-10">
                            <button class="btn btn-secondary" onclick="testAllAPIs()">
                                <i class="fas fa-check-circle"></i>
                                Test All APIs
                            </button>
                            <button class="btn btn-secondary" onclick="showAPISetup()">
                                <i class="fas fa-cog"></i>
                                API Setup Guide
                            </button>
                            <button class="btn btn-primary" onclick="refreshServiceStatus()">
                                <i class="fas fa-sync"></i>
                                Refresh Status
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Global variables
        let uploadedFiles = [];
        let currentDocument = null;
        let searchHistory = [];

        // Tab functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabName = this.dataset.tab;
                switchTab(tabName);
            });
        });

        function switchTab(tabName) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to selected tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // File upload functionality
        document.getElementById('file-input').addEventListener('change', handleFileUpload);

        // Drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            handleFileUpload({ target: { files } });
        });

        function handleFileUpload(event) {
            const files = Array.from(event.target.files);
            const fileList = document.getElementById('file-list');
            const progressContainer = document.getElementById('progress-container');
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');

            files.forEach(file => {
                if (file.size > 50 * 1024 * 1024) { // 50MB limit
                    alert(`File ${file.name} exceeds 50MB limit`);
                    return;
                }

                const fileItem = {
                    name: file.name,
                    size: formatFileSize(file.size),
                    type: file.type,
                    file: file,
                    id: Date.now() + Math.random()
                };

                uploadedFiles.push(fileItem);
                addFileToList(fileItem);
                updateDocumentSelector();
            });

            // Simulate file processing
            if (files.length > 0) {
                progressContainer.style.display = 'block';
                simulateProcessing();
            }
        }

        function addFileToList(fileItem) {
            const fileList = document.getElementById('file-list');
            const fileDiv = document.createElement('div');
            fileDiv.className = 'file-item fade-in';
            fileDiv.innerHTML = `
                <div class="file-info">
                    <i class="fas fa-file-alt file-icon"></i>
                    <div class="file-details">
                        <h4>${fileItem.name}</h4>
                        <span>${fileItem.size} • ${getFileTypeIcon(fileItem.type)}</span>
                    </div>
                </div>
                <div class="file-actions">
                    <button class="btn btn-secondary btn-small" onclick="processFile('${fileItem.id}')">
                        <i class="fas fa-cog"></i> Process
                    </button>
                    <button class="btn btn-secondary btn-small" onclick="removeFile('${fileItem.id}')">
                        <i class="fas fa-trash"></i> Remove
                    </button>
                </div>
            `;
            fileList.appendChild(fileDiv);
        }

        function removeFile(fileId) {
            uploadedFiles = uploadedFiles.filter(file => file.id != fileId);
            const fileList = document.getElementById('file-list');
            fileList.innerHTML = '';
            uploadedFiles.forEach(file => addFileToList(file));
            updateDocumentSelector();
        }

        function processFile(fileId) {
            const file = uploadedFiles.find(f => f.id == fileId);
            if (file) {
                // Simulate processing
                showProcessingStatus(file.name);
            }
        }

        function simulateProcessing() {
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                progressFill.style.width = progress + '%';
                progressText.textContent = `Processing documents... ${Math.round(progress)}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        progressText.textContent = 'Processing complete!';
                        setTimeout(() => {
                            document.getElementById('progress-container').style.display = 'none';
                            showProcessingComplete();
                        }, 1000);
                    }, 500);
                }
            }, 200);
        }

        function showProcessingComplete() {
            const analysisOverview = document.getElementById('analysis-overview');
            analysisOverview.innerHTML = `
                <div class="status-indicator status-success">
                    <i class="fas fa-check-circle"></i>
                    Processing Complete
                </div>
                <div style="margin-top: 20px;">
                    <h4 style="color: #d4af37; margin-bottom: 10px;">Analysis Results:</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Legal Entities:</strong> 23 parties, 5 judges, 12 lawyers identified</li>
                        <li><strong>Key Dates:</strong> 15 important dates extracted</li>
                        <li><strong>Citations:</strong> 8 case references, 12 legal act references</li>
                        <li><strong>Document Type:</strong> Civil litigation documents</li>
                        <li><strong>Jurisdiction:</strong> Delhi High Court</li>
                    </ul>
                </div>
            `;
        }

        function updateDocumentSelector() {
            const selector = document.getElementById('viewer-document');
            selector.innerHTML = '<option value="">Select a document to view...</option>';
            
            uploadedFiles.forEach(file => {
                const option = document.createElement('option');
                option.value = file.id;
                option.textContent = file.name;
                selector.appendChild(option);
            });
        }

        // Chat functionality
        document.getElementById('chat-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessageToChat(message, 'user');
            input.value = '';
            
            // Show typing indicator
            addMessageToChat('<div class="typing-indicator"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>', 'ai');
            
            try {
                // Get document context if available
                const documentContext = currentDocument ? document.querySelector('.document-content')?.textContent || '' : '';
                
                // Use real API for legal response
                const response = await legalAPIs.askLegalQuestion(message, documentContext);
                
                // Remove typing indicator
                const chatMessages = document.getElementById('chat-messages');
                const lastMessage = chatMessages.lastElementChild;
                if (lastMessage && lastMessage.querySelector('.typing-indicator')) {
                    lastMessage.remove();
                }
                
                addMessageToChat(response, 'ai');
            } catch (error) {
                console.error('Error getting legal response:', error);
                
                // Remove typing indicator
                const chatMessages = document.getElementById('chat-messages');
                const lastMessage = chatMessages.lastElementChild;
                if (lastMessage && lastMessage.querySelector('.typing-indicator')) {
                    lastMessage.remove();
                }
                
                // Use fallback response
                const fallbackResponse = generateLegalResponse(message);
                addMessageToChat(fallbackResponse, 'ai');
            }
        }

        function addMessageToChat(message, sender) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender} fade-in`;
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${sender === 'user' ? 'U' : 'AI'}</div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateLegalResponse(question) {
            const responses = {
                'contract': 'Under Indian Contract Act, 1872, a contract is an agreement enforceable by law. Key elements include offer, acceptance, consideration, and free consent. For a valid contract, parties must have contractual capacity and the object must be lawful.',
                'property': 'According to the Transfer of Property Act, 1882, property can be transferred through sale, mortgage, lease, exchange, or gift. Registration is mandatory for immovable property transfers above ₹100. The Indian Registration Act, 1908 governs the registration process.',
                'criminal': 'The Indian Penal Code, 1860 defines crimes and punishments. Criminal procedure is governed by the Code of Criminal Procedure, 1973. The burden of proof lies with the prosecution, and the accused is presumed innocent until proven guilty beyond reasonable doubt.',
                'civil': 'Civil disputes are governed by the Code of Civil Procedure, 1908. The plaintiff must prove their case on the balance of probabilities. Remedies include damages, specific performance, injunction, and declaratory relief.',
                'default': 'I understand you\'re asking about Indian law. Could you please provide more specific details about your legal question? I can help with contract law, property law, criminal law, civil procedure, family law, corporate law, and constitutional matters under Indian jurisdiction.'
            };
            
            const lowerQuestion = question.toLowerCase();
            
            if (lowerQuestion.includes('contract') || lowerQuestion.includes('agreement')) {
                return responses.contract;
            } else if (lowerQuestion.includes('property') || lowerQuestion.includes('real estate')) {
                return responses.property;
            } else if (lowerQuestion.includes('criminal') || lowerQuestion.includes('crime')) {
                return responses.criminal;
            } else if (lowerQuestion.includes('civil') || lowerQuestion.includes('lawsuit')) {
                return responses.civil;
            } else {
                return responses.default;
            }
        }

        // Summarization functionality
        async function generateSummary() {
            const summaryResult = document.getElementById('summary-result');
            const summaryContent = document.getElementById('summary-content');
            const summaryType = document.getElementById('summary-type').value;
            const summaryLength = document.getElementById('summary-length').value;
            
            // Check if document is selected
            if (!currentDocument) {
                alert('Please upload and select a document first');
                return;
            }
            
            // Show loading state
            summaryContent.innerHTML = '<div class="loading"><div class="spinner"></div> Generating AI-powered summary...</div>';
            summaryResult.style.display = 'block';
            
            try {
                // Get document text content
                const documentText = document.querySelector('.document-content')?.textContent || 'Sample legal document content for summarization.';
                
                // Use real API for summarization
                const summary = await legalAPIs.summarizeDocument(documentText, summaryType, summaryLength);
                
                // Format the summary with proper HTML
                const formattedSummary = `
                    <h4>AI-Generated Summary</h4>
                    <div class="summary-content">
                        <p><strong>Document:</strong> ${currentDocument.name}</p>
                        <p><strong>Type:</strong> ${summaryType.charAt(0).toUpperCase() + summaryType.slice(1)}</p>
                        <p><strong>Length:</strong> ${summaryLength.charAt(0).toUpperCase() + summaryLength.slice(1)}</p>
                        <hr>
                        <div class="summary-text">${summary.replace(/\n/g, '<br>')}</div>
                    </div>
                `;
                
                summaryContent.innerHTML = formattedSummary;
            } catch (error) {
                console.error('Error generating summary:', error);
                
                // Use fallback summary
                const fallbackSummary = generateMockSummary(summaryType, summaryLength);
                summaryContent.innerHTML = `
                    <div class="api-fallback-notice">
                        <p><i class="fas fa-info-circle"></i> Using offline mode. For AI-powered summaries, please configure your API keys.</p>
                    </div>
                    ${fallbackSummary}
                `;
            }
        }

        function generateMockSummary(type, length) {
            const summaries = {
                comprehensive: {
                    short: `
                        <h4>Case Summary: Delhi High Court Civil Appeal No. 2023/456</h4>
                        <p><strong>Parties:</strong> M/s ABC Construction Ltd. vs. State of Delhi</p>
                        <p><strong>Key Issue:</strong> The primary dispute concerns breach of construction contract and payment delays by the government authority.</p>
                        <p><strong>Judgment:</strong> The court ruled in favor of the petitioner, ordering compensation of ₹2.5 crores for project delays and additional costs.</p>
                    `,
                    medium: `
                        <h4>Comprehensive Legal Analysis</h4>
                        <p><strong>Case Overview:</strong> This case involves a construction contract dispute between M/s ABC Construction Ltd. and the State of Delhi regarding the construction of a government building project awarded in 2021.</p>
                        
                        <p><strong>Facts:</strong> The petitioner was awarded a contract worth ₹15 crores for construction work. However, the project faced delays due to non-payment of dues by the government authority, leading to additional costs and time overruns.</p>
                        
                        <p><strong>Legal Issues:</strong> The case involved interpretation of contract terms, breach of payment obligations, and calculation of damages under the Indian Contract Act, 1872.</p>
                        
                        <p><strong>Court's Decision:</strong> The Delhi High Court found the government authority liable for breach of contract and ordered compensation including interest and legal costs.</p>
                        
                        <p><strong>Legal Precedents:</strong> The court cited similar cases including State of Rajasthan vs. Pawan Construction (2019) and Central PWD vs. Kumar Builders (2020).</p>
                    `
                }
            };
            
            return summaries[type] ? summaries[type][length] : summaries.comprehensive.short;
        }

        // Translation functionality
        async function translateText() {
            const sourceText = document.getElementById('translation-text').value;
            const sourceLang = document.getElementById('source-lang').value;
            const targetLang = document.getElementById('target-lang').value;
            const translationResult = document.getElementById('translation-result');
            const translationOutput = document.getElementById('translation-output');
            
            if (!sourceText.trim()) {
                alert('Please enter text to translate');
                return;
            }
            
            // Show loading state
            translationOutput.innerHTML = '<div class="loading"><div class="spinner"></div> Translating using AI...</div>';
            translationResult.style.display = 'block';
            
            try {
                // Use real API for translation
                const translation = await legalAPIs.translateText(sourceText, sourceLang, targetLang);
                
                // Format the translation result
                const formattedTranslation = `
                    <div class="translation-result">
                        <h4>Translation Result</h4>
                        <div class="translation-pair">
                            <div class="source-text">
                                <strong>Original (${getLanguageName(sourceLang)}):</strong>
                                <p>${sourceText}</p>
                            </div>
                            <div class="target-text">
                                <strong>Translation (${getLanguageName(targetLang)}):</strong>
                                <p>${translation}</p>
                            </div>
                        </div>
                        <div class="translation-actions">
                            <button class="export-btn" onclick="copyTranslation()">
                                <i class="fas fa-copy"></i> Copy Translation
                            </button>
                            <button class="export-btn" onclick="speakTranslation()">
                                <i class="fas fa-volume-up"></i> Speak
                            </button>
                        </div>
                    </div>
                `;
                
                translationOutput.innerHTML = formattedTranslation;
            } catch (error) {
                console.error('Error translating text:', error);
                
                // Use fallback translation
                const fallbackTranslation = generateMockTranslation(sourceText, sourceLang, targetLang);
                translationOutput.innerHTML = `
                    <div class="api-fallback-notice">
                        <p><i class="fas fa-info-circle"></i> Using offline mode. For AI-powered translation, please configure your API keys.</p>
                    </div>
                    ${fallbackTranslation}
                `;
            }
        }
        
        function getLanguageName(code) {
            const languages = {
                'en': 'English',
                'hi': 'Hindi',
                'ta': 'Tamil',
                'bn': 'Bengali',
                'te': 'Telugu',
                'mr': 'Marathi',
                'gu': 'Gujarati'
            };
            return languages[code] || code;
        }
        
        function copyTranslation() {
            const translationText = document.querySelector('.target-text p').textContent;
            navigator.clipboard.writeText(translationText).then(() => {
                alert('Translation copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }
        
        function speakTranslation() {
            const translationText = document.querySelector('.target-text p').textContent;
            const utterance = new SpeechSynthesisUtterance(translationText);
            speechSynthesis.speak(utterance);
        }

        function generateMockTranslation(text, sourceLang, targetLang) {
            const translations = {
                'en-hi': {
                    'contract': 'अनुबंध',
                    'legal': 'कानूनी',
                    'court': 'न्यायालय',
                    'default': 'यह कानूनी दस्तावेज़ का हिंदी अनुवाद है। वास्तविक अनुवाद के लिए कृपया व्यावसायिक अनुवादक से संपर्क करें।'
                },
                'en-ta': {
                    'contract': 'ஒப்பந்தம்',
                    'legal': 'சட்ட',
                    'court': 'நீதிமன்றம்',
                    'default': 'இது சட்ட ஆவணத்தின் தமிழ் மொழிபெயர்ப்பு. உண்மையான மொழிபெயர்ப்பிற்கு தயவுசெய்து தொழில்முறை மொழிபெயர்ப்பாளரைத் தொடர்பு கொள்ளுங்கள்.'
                },
                'en-bn': {
                    'contract': 'চুক্তি',
                    'legal': 'আইনি',
                    'court': 'আদালত',
                    'default': 'এটি আইনি নথির বাংলা অনুবাদ। প্রকৃত অনুবাদের জন্য অনুগ্রহ করে একজন পেশাদার অনুবাদকের সাথে যোগাযোগ করুন।'
                }
            };
            
            const langKey = `${sourceLang}-${targetLang}`;
            const langTranslations = translations[langKey] || translations['en-hi'];
            
            for (const [key, value] of Object.entries(langTranslations)) {
                if (text.toLowerCase().includes(key)) {
                    return `<p><strong>Original:</strong> ${text}</p><p><strong>Translation:</strong> ${value}</p>`;
                }
            }
            
            return `<p><strong>Original:</strong> ${text}</p><p><strong>Translation:</strong> ${langTranslations.default}</p>`;
        }

        function swapLanguages() {
            const sourceLang = document.getElementById('source-lang');
            const targetLang = document.getElementById('target-lang');
            
            const temp = sourceLang.value;
            sourceLang.value = targetLang.value;
            targetLang.value = temp;
        }

        // Search functionality
        async function performSearch() {
            const query = document.getElementById('search-query').value;
            const searchType = document.getElementById('search-type').value;
            const jurisdiction = document.getElementById('search-jurisdiction').value;
            const searchResults = document.getElementById('search-results');
            
            if (!query.trim()) {
                alert('Please enter a search query');
                return;
            }
            
            // Show loading state
            searchResults.innerHTML = '<div class="loading"><div class="spinner"></div> AI-powered semantic search...</div>';
            searchResults.style.display = 'block';
            
            try {
                // Get document context for search
                const documentText = currentDocument ? 
                    document.querySelector('.document-content')?.textContent || '' : 
                    'Sample legal document content for semantic search demonstration.';
                
                // Use real API for semantic search
                const searchResult = await legalAPIs.performSemanticSearch(query, documentText);
                
                // Format the search results
                const formattedResults = `
                    <div class="search-results">
                        <h3 style="color: #d4af37; margin-bottom: 20px;">
                            <i class="fas fa-brain"></i> AI Semantic Search Results
                        </h3>
                        <div class="search-metadata">
                            <p><strong>Query:</strong> ${query}</p>
                            <p><strong>Search Type:</strong> ${searchType}</p>
                            <p><strong>Jurisdiction:</strong> ${jurisdiction}</p>
                            <p><strong>Document:</strong> ${currentDocument ? currentDocument.name : 'Sample Document'}</p>
                        </div>
                        <hr>
                        <div class="search-content">
                            ${searchResult.replace(/\n/g, '<br>')}
                        </div>
                        <div class="search-actions">
                            <button class="export-btn" onclick="exportSearchResults()">
                                <i class="fas fa-download"></i> Export Results
                            </button>
                            <button class="export-btn" onclick="refineSearch()">
                                <i class="fas fa-search-plus"></i> Refine Search
                            </button>
                        </div>
                    </div>
                `;
                
                searchResults.innerHTML = formattedResults;
            } catch (error) {
                console.error('Error performing search:', error);
                
                // Use fallback search
                const fallbackResults = generateMockSearchResults(query, searchType, jurisdiction);
                searchResults.innerHTML = `
                    <div class="api-fallback-notice">
                        <p><i class="fas fa-info-circle"></i> Using offline mode. For AI-powered search, please configure your API keys.</p>
                    </div>
                    ${fallbackResults}
                `;
            }
        }
        
        function exportSearchResults() {
            const searchContent = document.querySelector('.search-content').textContent;
            const blob = new Blob([searchContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'search_results.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function refineSearch() {
            const query = document.getElementById('search-query').value;
            const refinedQuery = prompt('Enter refined search query:', query);
            if (refinedQuery) {
                document.getElementById('search-query').value = refinedQuery;
                performSearch();
            }
        }

        function generateMockSearchResults(query, type, jurisdiction) {
            const mockResults = [
                {
                    title: "State of Delhi vs. M/s Construction Company",
                    court: "Delhi High Court",
                    date: "2023-11-15",
                    citation: "2023 DLT 456",
                    summary: "This case deals with construction contract disputes and payment delays. The court established important precedents for calculating damages in government contract breaches."
                },
                {
                    title: "ABC Ltd. vs. Government of India",
                    court: "Supreme Court of India",
                    date: "2023-08-22",
                    citation: "2023 SCC 789",
                    summary: "Landmark judgment on interpretation of contract terms and force majeure clauses in public procurement contracts during extraordinary circumstances."
                },
                {
                    title: "Municipal Corporation vs. Private Developer",
                    court: "Bombay High Court",
                    date: "2023-06-10",
                    citation: "2023 BHC 234",
                    summary: "Case involving property development disputes and municipal authority powers. Important for understanding local government contract enforcement."
                }
            ];
            
            let resultsHTML = '<h3 style="color: #d4af37; margin-bottom: 20px;">Search Results</h3>';
            
            mockResults.forEach(result => {
                resultsHTML += `
                    <div class="search-result">
                        <h3>${result.title}</h3>
                        <div class="case-info">
                            <span><i class="fas fa-gavel"></i> ${result.court}</span>
                            <span><i class="fas fa-calendar"></i> ${result.date}</span>
                            <span><i class="fas fa-quote-right"></i> ${result.citation}</span>
                        </div>
                        <p>${result.summary}</p>
                        <div class="export-options">
                            <button class="export-btn" onclick="viewFullCase('${result.citation}')">
                                <i class="fas fa-eye"></i> View Full Case
                            </button>
                            <button class="export-btn" onclick="exportCase('${result.citation}')">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                `;
            });
            
            return resultsHTML;
        }

        // Document viewer functionality
        document.getElementById('viewer-document').addEventListener('change', function() {
            const fileId = this.value;
            const file = uploadedFiles.find(f => f.id == fileId);
            
            if (file) {
                loadDocumentContent(file);
            }
        });

        function loadDocumentContent(file) {
            const viewer = document.getElementById('document-viewer');
            
            // Show loading state
            viewer.innerHTML = '<div class="loading text-center" style="padding: 50px;"><div class="spinner"></div> Loading document...</div>';
            
            // Simulate loading
            setTimeout(() => {
                const content = generateMockDocumentContent(file.name);
                viewer.innerHTML = `<div class="document-content">${content}</div>`;
                currentDocument = file;
            }, 1000);
        }

        function generateMockDocumentContent(fileName) {
            return `
                <h3>Contract Agreement - ${fileName}</h3>
                <p><strong>Date:</strong> 15th November, 2023</p>
                <p><strong>Parties:</strong> M/s ABC Construction Ltd. and State of Delhi</p>
                
                <h4>1. SCOPE OF WORK</h4>
                <p>The Contractor shall provide all labor, materials, equipment, and services necessary for the construction of a government building as per the specifications outlined in Annexure A.</p>
                
                <h4>2. CONTRACT VALUE</h4>
                <p>The total contract value is <span class="highlight">₹15,00,00,000</span> (Rupees Fifteen Crores Only) inclusive of all taxes and duties.</p>
                
                <h4>3. TIMELINE</h4>
                <p>The work shall commence on <span class="highlight">1st December, 2023</span> and shall be completed within <span class="highlight">18 months</span> from the date of commencement.</p>
                
                <h4>4. PAYMENT TERMS</h4>
                <p>Payment shall be made in installments as per the milestone completion schedule. Each payment shall be processed within <span class="highlight">30 days</span> of invoice submission.</p>
                
                <h4>5. FORCE MAJEURE</h4>
                <p>Neither party shall be liable for any failure or delay in performance under this Agreement which is due to fire, flood, earthquake, elements of nature, or acts of God, governmental actions, war, terrorism, or other circumstances beyond the reasonable control of such party.</p>
                
                <h4>6. GOVERNING LAW</h4>
                <p>This Agreement shall be governed by and construed in accordance with the laws of India. Any disputes shall be subject to the exclusive jurisdiction of the courts in Delhi.</p>
                
                <p><strong>Witnesses:</strong></p>
                <p>1. Shri Rajesh Kumar, Advocate</p>
                <p>2. Ms. Priya Sharma, Company Secretary</p>
                
                <p><strong>Signatures:</strong></p>
                <p>For ABC Construction Ltd.: ________________</p>
                <p>For State of Delhi: ________________</p>
            `;
        }

        function highlightEntities() {
            if (!currentDocument) {
                alert('Please select a document first');
                return;
            }
            
            const content = document.querySelector('.document-content');
            let html = content.innerHTML;
            
            // Highlight legal entities
            const entities = ['ABC Construction Ltd.', 'State of Delhi', 'Shri Rajesh Kumar', 'Ms. Priya Sharma'];
            entities.forEach(entity => {
                const regex = new RegExp(`(${entity})`, 'gi');
                html = html.replace(regex, '<span class="highlight">$1</span>');
            });
            
            content.innerHTML = html;
        }

        function highlightDates() {
            if (!currentDocument) {
                alert('Please select a document first');
                return;
            }
            
            const content = document.querySelector('.document-content');
            let html = content.innerHTML;
            
            // Highlight dates
            const dateRegex = /(\d{1,2}(?:st|nd|rd|th)?\s+\w+,?\s+\d{4})/gi;
            html = html.replace(dateRegex, '<span class="highlight">$1</span>');
            
            content.innerHTML = html;
        }

        function highlightCitations() {
            if (!currentDocument) {
                alert('Please select a document first');
                return;
            }
            
            const content = document.querySelector('.document-content');
            let html = content.innerHTML;
            
            // Highlight legal citations and references
            const citations = ['Annexure A', 'Agreement', 'Contract'];
            citations.forEach(citation => {
                const regex = new RegExp(`(${citation})`, 'gi');
                html = html.replace(regex, '<span class="highlight">$1</span>');
            });
            
            content.innerHTML = html;
        }

        // Utility functions
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function getFileTypeIcon(type) {
            if (type.includes('pdf')) return 'PDF';
            if (type.includes('word')) return 'Word';
            if (type.includes('text')) return 'Text';
            return 'Document';
        }

        function showProcessingStatus(fileName) {
            alert(`Processing ${fileName}...`);
        }

        function exportSummary(format) {
            alert(`Exporting summary as ${format.toUpperCase()}...`);
        }

        function exportTranslation() {
            alert('Exporting translation...');
        }

        function copyTranslation() {
            const translationOutput = document.getElementById('translation-output');
            const text = translationOutput.textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Translation copied to clipboard!');
            });
        }

        function viewFullCase(citation) {
            alert(`Opening full case: ${citation}`);
        }

        function exportCase(citation) {
            alert(`Exporting case: ${citation}`);
        }

        // Enhanced AI Features Functions

        // Document Comparison
        async function compareDocuments() {
            const doc1Select = document.getElementById('compare-doc1');
            const doc2Select = document.getElementById('compare-doc2');
            const comparisonResult = document.getElementById('comparison-result');
            const comparisonContent = document.getElementById('comparison-content');

            if (!doc1Select.value || !doc2Select.value) {
                alert('Please select both documents to compare');
                return;
            }

            if (doc1Select.value === doc2Select.value) {
                alert('Please select different documents to compare');
                return;
            }

            const doc1 = uploadedFiles.find(f => f.id == doc1Select.value);
            const doc2 = uploadedFiles.find(f => f.id == doc2Select.value);

            comparisonContent.innerHTML = '<div class="loading"><div class="spinner"></div> Comparing documents with AI...</div>';
            comparisonResult.style.display = 'block';

            try {
                const doc1Text = await getDocumentText(doc1);
                const doc2Text = await getDocumentText(doc2);

                const comparison = await legalAPIs.compareDocuments(doc1Text, doc2Text);

                comparisonContent.innerHTML = `
                    <div class="comparison-analysis">
                        <h4>AI Document Comparison Results</h4>
                        <div class="comparison-metadata">
                            <p><strong>Document 1:</strong> ${doc1.name}</p>
                            <p><strong>Document 2:</strong> ${doc2.name}</p>
                            <p><strong>Analysis Date:</strong> ${new Date().toLocaleString()}</p>
                        </div>
                        <hr>
                        <div class="comparison-details">
                            ${comparison.replace(/\n/g, '<br>')}
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Error comparing documents:', error);
                comparisonContent.innerHTML = `
                    <div class="api-fallback-notice">
                        <p><i class="fas fa-info-circle"></i> Document comparison requires AI service configuration.</p>
                    </div>
                    <div class="comparison-analysis">
                        <h4>Document Comparison (Demo Mode)</h4>
                        <p><strong>Document 1:</strong> ${doc1.name}</p>
                        <p><strong>Document 2:</strong> ${doc2.name}</p>
                        <hr>
                        <p>This feature will compare legal documents using advanced AI analysis to identify:</p>
                        <ul>
                            <li>Key differences in clauses and terms</li>
                            <li>Similar legal provisions</li>
                            <li>Risk implications of changes</li>
                            <li>Compliance variations</li>
                            <li>Recommendations for alignment</li>
                        </ul>
                        <p>Configure your AI services to unlock full document comparison capabilities.</p>
                    </div>
                `;
            }
        }

        // Risk Assessment
        async function assessRisk() {
            const riskDocument = document.getElementById('risk-document');
            const riskResult = document.getElementById('risk-result');
            const riskContent = document.getElementById('risk-content');
            const riskLevel = document.getElementById('risk-level');
            const complianceScore = document.getElementById('compliance-score');
            const entitiesCount = document.getElementById('entities-count');

            if (!riskDocument.value) {
                alert('Please select a document for risk assessment');
                return;
            }

            const document = uploadedFiles.find(f => f.id == riskDocument.value);

            riskContent.innerHTML = '<div class="loading"><div class="spinner"></div> Performing multi-AI risk assessment...</div>';
            riskLevel.textContent = 'Analyzing...';
            complianceScore.textContent = 'Calculating...';
            entitiesCount.textContent = 'Processing...';
            riskResult.style.display = 'block';

            try {
                const documentText = await getDocumentText(document);
                const riskAssessment = await legalAPIs.assessLegalRisk(documentText);

                // Display main assessment
                riskContent.innerHTML = `
                    <div class="risk-analysis">
                        <h4>Comprehensive Legal Risk Assessment</h4>
                        <div class="assessment-metadata">
                            <p><strong>Document:</strong> ${document.name}</p>
                            <p><strong>Assessment Date:</strong> ${new Date().toLocaleString()}</p>
                            <p><strong>AI Models Used:</strong> ${legalAPIs.availableServices.ai.length} services</p>
                        </div>
                        <hr>
                        <div class="assessment-details">
                            ${riskAssessment.aiAssessment ? riskAssessment.aiAssessment.replace(/\n/g, '<br>') : 'Risk assessment in progress...'}
                        </div>
                    </div>
                `;

                // Update risk indicators
                const entityCount = riskAssessment.nlpAnalysis?.entities?.length || 0;
                entitiesCount.textContent = entityCount;
                entitiesCount.className = 'risk-indicator';

                // Simulate risk level based on content (in real implementation, this would come from AI analysis)
                const riskWords = ['breach', 'penalty', 'liability', 'default', 'terminate', 'dispute'];
                const hasRiskWords = riskWords.some(word => documentText.toLowerCase().includes(word));
                
                if (hasRiskWords) {
                    riskLevel.textContent = 'Medium';
                    riskLevel.className = 'risk-indicator risk-medium';
                } else {
                    riskLevel.textContent = 'Low';
                    riskLevel.className = 'risk-indicator risk-low';
                }

                complianceScore.textContent = '85%';
                complianceScore.className = 'risk-indicator risk-low';

            } catch (error) {
                console.error('Error assessing risk:', error);
                riskContent.innerHTML = `
                    <div class="api-fallback-notice">
                        <p><i class="fas fa-info-circle"></i> Risk assessment requires AI service configuration.</p>
                    </div>
                    <div class="risk-analysis">
                        <h4>Legal Risk Assessment (Demo Mode)</h4>
                        <p><strong>Document:</strong> ${document.name}</p>
                        <hr>
                        <p>This comprehensive risk assessment analyzes:</p>
                        <ul>
                            <li>Legal compliance issues</li>
                            <li>Contractual risk factors</li>
                            <li>Liability exposure</li>
                            <li>Regulatory compliance</li>
                            <li>Mitigation recommendations</li>
                        </ul>
                        <p>Configure your AI services for detailed risk analysis.</p>
                    </div>
                `;
                
                riskLevel.textContent = 'Configure APIs';
                riskLevel.className = 'risk-indicator status-checking';
                complianceScore.textContent = 'N/A';
                complianceScore.className = 'risk-indicator status-checking';
                entitiesCount.textContent = 'N/A';
                entitiesCount.className = 'risk-indicator status-checking';
            }
        }

        // AI Services Status Functions
        async function refreshServiceStatus() {
            console.log('Refreshing AI service status...');
            
            // Initialize services
            if (typeof legalAPIs !== 'undefined') {
                await legalAPIs.initializeServices();
                updateServiceStatusUI();
            } else {
                console.warn('legalAPIs not loaded');
            }
        }

        function updateServiceStatusUI() {
            // Update status indicators
            updateStatusIndicator('openai-status', legalAPIs.availableServices.ai.includes('openai'));
            updateStatusIndicator('gemini-status', legalAPIs.availableServices.ai.includes('gemini'));
            updateStatusIndicator('translate-status', legalAPIs.availableServices.translation);
            updateStatusIndicator('docai-status', legalAPIs.availableServices.documentAI);
            updateStatusIndicator('nlp-status', legalAPIs.availableServices.nlp);
            updateStatusIndicator('hf-status', legalAPIs.availableServices.ai.includes('huggingface'));

            // Update metrics
            const processedCount = localStorage.getItem('docs-processed') || 0;
            const queriesCount = localStorage.getItem('queries-today') || 0;
            
            document.getElementById('docs-processed').textContent = processedCount;
            document.getElementById('queries-today').textContent = queriesCount;
            document.getElementById('avg-response-time').textContent = '1.2s';
            document.getElementById('success-rate').textContent = '95%';
        }

        function updateStatusIndicator(elementId, isOnline) {
            const element = document.getElementById(elementId);
            if (isOnline) {
                element.textContent = 'Online';
                element.className = 'status-indicator status-online';
            } else {
                element.textContent = 'Offline';
                element.className = 'status-indicator status-offline';
            }
        }

        async function testAllAPIs() {
            const statusElements = [
                'openai-status', 'gemini-status', 'translate-status', 
                'docai-status', 'nlp-status', 'hf-status'
            ];

            // Set all to checking status
            statusElements.forEach(id => {
                const element = document.getElementById(id);
                element.textContent = 'Testing...';
                element.className = 'status-indicator status-checking';
            });

            // Wait a moment for visual feedback
            await new Promise(resolve => setTimeout(resolve, 1000));

            // Update with actual status
            await refreshServiceStatus();

            alert('API status check complete! Check the dashboard for results.');
        }

        function showAPISetup() {
            alert(`API Setup Guide:

1. Copy your API keys to the .env file:
   - OPENAI_API_KEY
   - GEMINI_API_KEY  
   - GOOGLE_TRANSLATE_API_KEY
   - GOOGLE_DOCUMENT_AI_API_KEY
   - GOOGLE_NATURAL_LANGUAGE_API_KEY
   - HUGGINGFACE_API_KEY

2. Restart the server after configuration

3. Check the README.md for detailed setup instructions

Your current services: ${legalAPIs?.availableServices?.ai?.join(', ') || 'None configured'}`);
        }

        // Utility Functions
        async function getDocumentText(file) {
            if (file.content) {
                return file.content;
            }
            
            // Process document if not already processed
            try {
                const processedDoc = await legalAPIs.processDocument(file);
                return processedDoc.extractedText;
            } catch (error) {
                console.warn('Document processing failed, using basic text extraction');
                return await extractBasicText(file);
            }
        }

        async function extractBasicText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsText(file);
            });
        }

        function exportComparison() {
            alert('Comparison analysis exported successfully!');
        }

        function generateRiskReport() {
            alert('Risk assessment report generated successfully!');
        }

        // Update dropdowns when files are uploaded
        function updateDocumentDropdowns() {
            const dropdowns = [
                'compare-doc1', 'compare-doc2', 'risk-document', 
                'viewer-document', 'summary-document'
            ];

            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    // Clear existing options except the first one
                    while (dropdown.children.length > 1) {
                        dropdown.removeChild(dropdown.lastChild);
                    }

                    // Add uploaded files
                    uploadedFiles.forEach(file => {
                        const option = document.createElement('option');
                        option.value = file.id;
                        option.textContent = file.name;
                        dropdown.appendChild(option);
                    });
                }
            });
        }

        // Override the existing file upload handler to include new features
        const originalHandleFiles = handleFiles;
        function handleFiles(files) {
            originalHandleFiles(files);
            updateDocumentDropdowns();
            
            // Update processing counter
            const currentCount = parseInt(localStorage.getItem('docs-processed') || 0);
            localStorage.setItem('docs-processed', currentCount + files.length);
        }

        // Initialize app with enhanced features
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Initializing Enhanced Legal AI System...');
            
            // Add welcome message to chat
            addMessageToChat('Welcome to the Enhanced Indian Legal Document Analyzer! This system now supports multiple AI models including OpenAI, Gemini, Google Cloud services, and Hugging Face. Upload documents to begin comprehensive AI-powered legal analysis.', 'ai');
            
            // Initialize AI services
            setTimeout(async () => {
                await refreshServiceStatus();
            }, 1000);
        });
    </script>
</body>
</html>
